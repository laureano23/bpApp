<?php

namespace Mbp\ArticulosBundle\Entity;

/**
 * RemitosClientesRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class RemitosClientesRepository extends \Doctrine\ORM\EntityRepository
{
	public function listarRemitosPendientesFacturacion(){
		$em = $this->getEntityManager();
		
		$repo = $em->getRepository('MbpArticulosBundle:RemitosClientes');
		$res = $repo->createQueryBuilder('r')
						->select('r.id, d.descripcion, d.cantidad, d.unidad,
						 	art.codigo, d.oc, p.id as pedido, d.facturado,
						 	art.costo, art.precio')
						->join('r.detalleRemito', 'd')
						->join('d.articuloId', 'art')
						->leftjoin('d.pedidoId', 'p')
						->where('d.facturado = 0')
						->getQuery()
						->getResult();
		
		return $res;
	}
	
}
